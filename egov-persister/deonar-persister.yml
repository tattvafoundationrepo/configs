serviceMaps:
  serviceName: deonar-services
  mappings:
    - version: 1.0
      description: Persists Deonar arrival details
      fromTopic: topic_deonar_arrival
      isTransaction: true
      queryMaps:
        - query:  |
                  INSERT INTO eg_deonar_arrival 
                  (arrivalId, importPermission, stakeholderId, dateOfArrival, timeOfArrival, vehicleNumber, createdAt, updatedAt, createdBy, updatedBy) 
                  VALUES (?,?, ?, ?, ?, ?, ?, ?, ?, ?)
                  RETURNING id;
          basePath: $.ArrivalDetails
          jsonMaps:
            - jsonPath: $.ArrivalDetails.arrivalId
            - jsonPath: $.ArrivalDetails.importPermission
            - jsonPath: $.ArrivalDetails.stakeholderId
            - jsonPath: $.ArrivalDetails.dateOfArrival
            - jsonPath: $.ArrivalDetails.timeOfArrival
            - jsonPath: $.ArrivalDetails.vehicleNumber
            - jsonPath: $.ArrivalDetails.createdAt
            - jsonPath: $.ArrivalDetails.updatedAt
            - jsonPath: $.ArrivalDetails.createdBy
            - jsonPath: $.ArrivalDetails.updatedBy
        - query:  |
                  INSERT INTO eg_deonar_animal_at_arrival 
                  (arrivalId, animalTypeId, count, createdAt, updatedAt, createdBy, updatedBy)
                  VALUES ((select id from eg_deonar_arrival  where arrivalId = ?), ?, ?, ?, ?, ?, ?);
          basePath: $.AnimalDetails.* # Reference directly without [*] to align with Java handling
          jsonMaps:
            - jsonPath: $.ArrivalDetails.arrivalId
            - jsonPath: $.AnimalDetails.*.animalTypeId
            - jsonPath: $.AnimalDetails.*.count
            - jsonPath: $.AnimalDetails.*.createdAt
            - jsonPath: $.AnimalDetails.*.updatedAt
            - jsonPath: $.AnimalDetails.*.createdBy
            - jsonPath: $.AnimalDetails.*.updatedBy
